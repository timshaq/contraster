!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Contraster",[],t):"object"==typeof exports?exports.Contraster=t():e.Contraster=t()}(self,(function(){return(()=>{"use strict";var e={d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>d});var s="contraster-active-separator";function r(){switch(this.options.direction){case"horizontal":return"contraster horizontal";case"diagonal":return"contraster diagonal";case"square":return"contraster square";default:return"contraster"}}function o(e,t){this.container=function(e){if(e){if(e.nodeType)return e;if("string"==typeof e)return document.querySelector(arguments[0])}return null}(this.options.container),this.container||t(),this.container.className=r.call(this),this.options.className&&(this.container.className+=` ${this.options.className}`),this.beforeWrapper=document.createElement("DIV"),this.beforeWrapper.className="contraster-wrapper-before",this.beforeElement=document.createElement("IMG"),this.beforeElement.onload=o,this.beforeElement.onerror=t,this.beforeElement.src=this.container.getAttribute("data-before"),this.container.removeAttribute("data-before"),this.beforeWrapper.append(this.beforeElement),this.afterWrapper=document.createElement("DIV"),this.afterWrapper.className="contraster-wrapper-after",this.afterElement=document.createElement("IMG"),this.afterElement.onload=o,this.afterElement.onerror=t,this.afterElement.src=this.container.getAttribute("data-after"),this.container.removeAttribute("data-after"),this.afterWrapper.append(this.afterElement),this.separator=document.createElement("DIV"),this.separator.className="contraster-separator",this.options.separator&&this.options.separator.class&&(this.separator.className+=` ${this.options.separator.class}`),this.options.separator&&this.options.separator.innerHTML&&(this.separator.innerHTML+=` ${this.options.separator.innerHTML}`),this.container.append(this.beforeWrapper,this.afterWrapper,this.separator),this.options.separator.innerHTML&&(this.separatorChildren=Array.prototype.slice.call(this.separator.children));const s=[];function o(){if(s.push(!0),2===s.length)return e()}}const n=function(){return new Promise(o.bind(this))},i=function(){switch(this.options.direction){case"horizontal":const e=this.container.offsetHeight*this.options.progress/100;this.beforeWrapper.style.cssText=`height: ${e}px;`,this.beforeElement.style.height=this.container.offsetHeight+"px",this.separator.style.cssText=`top: ${e}px;`;break;case"diagonal":const t=this.container.offsetWidth,s=this.container.offsetHeight,r=Math.sqrt(t*t+s*s),o=2*Math.atan(t/s)*180/Math.PI,n=180*Math.atan(s/t)/Math.PI,i=-(90-180*Math.atan(s/t)/Math.PI),a=-1*i,p=o+n;this.beforeWrapper.style.cssText=`\n                width: ${2*t*this.options.progress/100}px;\n                height: ${s}px;\n                overflow: hidden;\n                position: absolute;\n                top: 0;\n                left: 0;\n                transform-origin: 100% 0;\n                transform: skewX(${i}deg);\n            `,this.beforeElement.style.cssText=`\n                width: ${t}px;\n                transform-origin: inherit;\n                transform: skewX(${a}deg);\n            `,this.separator.style.cssText=`\n                width: ${r}px;\n                top: ${this.container.offsetHeight*this.options.progress/100}px;\n                left: ${this.container.offsetWidth*this.options.progress/100}px;\n                transform: translate(-50%,-50%) rotate(${p}deg)\n            `;break;default:const c=this.container.offsetWidth*this.options.progress/100;this.beforeWrapper.style.cssText=`width: ${c}px;`,this.separator.style.cssText=`left: ${c}px;`}this.emit("setSizes")},a=function(e,t,s){let r,o,n=e.container.offsetTop;if(s.touches&&(t.setContainerMove(!0),r=s.touches[0].pageY,o=s.touches[0].pageX),s.pageY&&(r=s.pageY,o=s.pageX),r-=n,e.separator.classList.add(e.options.separator.activeClass),"vertical"===e.options.direction&&(o>0?o<e.container.offsetWidth?(e.separator.style.cssText=`left: ${o}px;`,e.beforeWrapper.style.cssText=`width: ${o}px;`):(e.separator.style.cssText=`left: ${e.container.offsetWidth}px;`,e.beforeWrapper.style.cssText=`width: ${e.container.offsetWidth}px;`):(e.beforeWrapper.style.cssText="width: 0px;",e.separator.style.cssText="left: 0px;")),"horizontal"===e.options.direction&&(r>0?r<e.container.offsetHeight?(e.beforeWrapper.style.cssText=`height: ${r}px;`,e.separator.style.cssText=`top: ${r}px;`):(e.beforeWrapper.style.cssText=`height: ${e.container.offsetHeight}px;`,e.separator.style.cssText=`top: ${e.container.offsetHeight}px;`):(e.beforeWrapper.style.cssText="height: 0px;",e.separator.style.cssText="top: 0px;")),"diagonal"===e.options.direction){let t=e.container.offsetHeight,s=e.container.offsetWidth,n=t*o/s;o=(o+r*s/t)/2,r=(r+n)/2,o>0?o<e.container.offsetWidth?(e.separator.style.left=`${o}px`,e.beforeWrapper.style.width=2*o+"px"):(e.separator.style.left=`${e.container.offsetWidth}px`,e.beforeWrapper.style.width=2*e.container.offsetWidth+"px"):(e.beforeWrapper.style.width="0px",e.separator.style.left="0px"),r>0?r<e.container.offsetHeight?e.separator.style.top=`${r}px`:e.separator.style.top=`${e.container.offsetHeight}px`:e.separator.style.top="0px"}},p=function(e,t,s,r){if(0===r.button||r.touches){const o=e.separatorChildren&&e.separatorChildren.includes(r.target);e.options.freePosition?(r.target===e.container||o||r.target===e.separator)&&(s(r),t.on("mousemove",s)):(r.target===e.separator||o)&&t.on("mousemove",s)}},c=function(e,t,s){t.off("mousemove",s),e.separator.classList.remove(e.options.separator.activeClass)};function f(e){return e&&"object"==typeof e&&!Array.isArray(e)&&!e.nodeType}const h=function e(t,s){return f(t)&&f(s)?(Object.keys(s).forEach((r=>{const o=t[r],n=s[r];Array.isArray(o)&&Array.isArray(n)?t[r]=o.concat(n):f(o)&&f(n)?t[r]=e(Object.assign({},o),n):t[r]=n})),t):s},l=new function(){var e=this;function t(t){e.isContainerMove=!1,e.emit("mouseup",t)}function s(t){e.emit("mousedown",t)}function r(t){return e.emit("mousemove",t),!!e.isContainerMove&&t.preventDefault()}e.isContainerMove=!1,e.setContainerMove=function(t){e.isContainerMove=t},e.eventsListeners={},e.on=function(t,s){e.eventsListeners[t]||(e.eventsListeners[t]=[]),e.eventsListeners[t].push(s)},e.off=function(t,s){e.eventsListeners[t]&&(e.eventsListeners[t]=e.eventsListeners[t].filter((function(e){return e!==s})))},e.emit=function(t,s){e.eventsListeners[t]&&e.eventsListeners[t].forEach((function(e){e(s)}))},document.addEventListener("mousedown",s),document.addEventListener("mouseup",t),document.addEventListener("mousemove",r),document.addEventListener("touchstart",s),document.addEventListener("touchend",t),document.addEventListener("touchcancel",t),document.addEventListener("touchmove",r,{passive:!1}),window.addEventListener("resize",(function(){e.emit("resize")}))};function u(){this.container=null,this.beforeWrapper=null,this.afterWrapper=null,this.separator=null,this.separatorChildren=null,this.eventsListeners={};const e={direction:"vertical",freePosition:!1,init:!0,separator:{activeClass:s},className:null,progress:50};arguments[0]&&"object"==typeof arguments[0]&&(this.options=h(e,arguments[0]));const t=this,r=e=>a(t,l,e),o=e=>p(t,l,r,e),f=()=>c(t,l,r);this.init=function(){n.call(t).then((()=>{t.container&&(this.emit("init"),i.call(t),this.options.debug&&console.log("resolve"),l.on("mousedown",o),l.on("mouseup",f),l.on("resize",i.bind(t)))})).catch((()=>{this.options.debug&&console.log("reject"),this.destroy()}))},this.destroy=function(){t.container&&(t.container.setAttribute("data-before",this.beforeElement.src),t.container.setAttribute("data-after",this.afterElement.src),t.container.innerHTML="",t.container.removeAttribute("class"),l.off("mousedown",o),l.off("mouseup",f),l.off("resize",i.bind(t))),t.emit("destroy")},this.setProgress=function(e){t.options.progress=e,i.call(t),t.emit("setProgress")},this.options.init&&this.init()}u.prototype.on=function(e,t){this.eventsListeners[e]||(this.eventsListeners[e]=[]),this.eventsListeners[e].push(t)},u.prototype.off=function(e,t){this.eventsListeners[e]&&(this.eventsListeners[e]=this.eventsListeners[e].filter((function(e){return e!==t})))},u.prototype.emit=function(e,t){this.eventsListeners[e]&&this.eventsListeners[e].forEach((function(e){e(t)}))};const d=u;return t.default})()}));